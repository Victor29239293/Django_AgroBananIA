{% extends 'components/base.html' %} 
{% block title %}BanaIA - Login & Registro{%endblock %} 
{% block extra_head %} {% endblock %} 
{% block content %}
<div class="login-page">
  <div class="login-container">
    <!-- Side Panel -->
    <div class="side-panel">
      {% comment %}
      <div class="logo">üçå</div>
      <h2>BanaIA</h2>
      <p>
        Protege tus cultivos de banano con la mejor tecnolog√≠a de inteligencia
        artificial. Detecta enfermedades antes de que sea tarde.
      </p>
      {% endcomment %}
    </div>

    <!-- Form Panel -->
    <div class="form-panel">
      <!-- Toggle Buttons -->
      <div class="toggle-btns">
        <button class="toggle-btn active" onclick="showForm('login')">
          Iniciar Sesi√≥n
        </button>
        <button class="toggle-btn" onclick="showForm('register')">
          Registrarse
        </button>
      </div>

      <!-- Login Form -->
      <div id="loginForm" class="form-container active">
        <div class="form-header">
          <h3>¬°Bienvenido de nuevo!</h3>
          <p>Ingresa tus credenciales para continuar</p>
        </div>

        <div class="error-message" id="loginError">
          <i class="fas fa-exclamation-circle"></i> Credenciales incorrectas
        </div>

        <form onsubmit="handleLogin(event)">
          <div class="form-group">
            <label for="loginEmail">Correo Electr√≥nico</label>
            <div class="input-wrapper">
              <i class="fas fa-envelope"></i>
              <input
                type="email"
                id="loginEmail"
                class="form-control"
                placeholder="tu@email.com"
                required
              />
            </div>
          </div>

          <div class="form-group">
            <label for="loginPassword">Contrase√±a</label>
            <div class="input-wrapper">
              <i class="fas fa-lock"></i>
              <input
                type="password"
                id="loginPassword"
                class="form-control"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                required
              />
              <span
                class="password-toggle"
                onclick="togglePassword('loginPassword')"
              >
                <i class="fas fa-eye"></i>
              </span>
            </div>
          </div>

          <div class="form-options">
            <div class="checkbox-wrapper">
              <input type="checkbox" id="rememberMe" />
              <label for="rememberMe">Recordarme</label>
            </div>
            <a href="#" class="forgot-password">¬øOlvidaste tu contrase√±a?</a>
          </div>

          <button type="submit" class="btn btn-primary">
            <i class="fas fa-sign-in-alt"></i> Iniciar Sesi√≥n
          </button>
        </form>

        <div class="divider">
          <span>o contin√∫a con</span>
        </div>

        <div class="social-login">
          <button class="btn-social btn-google">
            <i class="fab fa-google"></i>
            Google
          </button>
          <button class="btn-social btn-facebook">
            <i class="fab fa-facebook-f"></i>
            Facebook
          </button>
        </div>

        <div class="form-footer">
          ¬øNo tienes una cuenta?
          <a href="#" onclick="showForm('register')">Reg√≠strate aqu√≠</a>
        </div>
      </div>

      <!-- Register Form -->
      <div id="registerForm" class="form-container">
        <div class="form-header">
          <h3>Crear una cuenta</h3>
          <p>√önete a la revoluci√≥n agr√≠cola digital</p>
        </div>

        <div class="error-message" id="registerError">
          <i class="fas fa-exclamation-circle"></i> Por favor verifica los datos
        </div>

        <form onsubmit="handleRegister(event)">
          <div class="form-row">
            <div class="form-col">
              <div class="form-group">
                <label for="registerName">Nombre Completo</label>
                <div class="input-wrapper">
                  <i class="fas fa-user"></i>
                  <input
                    type="text"
                    id="registerName"
                    class="form-control"
                    placeholder="Juan P√©rez"
                    required
                  />
                </div>
              </div>
            </div>

            <div class="form-col">
              <div class="form-group">
                <label for="registerEmail">Correo Electr√≥nico</label>
                <div class="input-wrapper">
                  <i class="fas fa-envelope"></i>
                  <input
                    type="email"
                    id="registerEmail"
                    class="form-control"
                    placeholder="tu@email.com"
                    required
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-col">
              <div class="form-group">
                <label for="registerPassword">Contrase√±a</label>
                <div class="input-wrapper">
                  <i class="fas fa-lock"></i>
                  <input
                    type="password"
                    id="registerPassword"
                    class="form-control"
                    placeholder="M√≠nimo 8 caracteres"
                    required
                    minlength="8"
                  />
                </div>
              </div>
            </div>

            <div class="form-col">
              <div class="form-group">
                <label for="registerConfirmPassword"
                  >Confirmar Contrase√±a</label
                >
                <div class="input-wrapper">
                  <i class="fas fa-lock"></i>
                  <input
                    type="password"
                    id="registerConfirmPassword"
                    class="form-control"
                    placeholder="Repite tu contrase√±a"
                    required
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="form-options">
            <div class="checkbox-wrapper">
              <input type="checkbox" id="acceptTerms" required />
              <label for="acceptTerms">Acepto los t√©rminos y condiciones</label>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">
            <i class="fas fa-user-plus"></i> Crear Cuenta
          </button>
        </form>

        <div class="divider">
          <span>o reg√≠strate con</span>
        </div>

        <div class="social-login">
          <button class="btn-social btn-google">
            <i class="fab fa-google"></i>
            Google
          </button>
          <button class="btn-social btn-facebook">
            <i class="fab fa-facebook-f"></i>
            Facebook
          </button>
        </div>

        <div class="form-footer">
          ¬øYa tienes una cuenta?
          <a href="#" onclick="showForm('login')">Inicia sesi√≥n aqu√≠</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    function showForm(formType) {
      const loginForm = document.getElementById("loginForm");
      const registerForm = document.getElementById("registerForm");
      const toggleBtns = document.querySelectorAll(".toggle-btn");

      if (formType === "login") {
        loginForm.classList.add("active");
        registerForm.classList.remove("active");
        toggleBtns[0].classList.add("active");
        toggleBtns[1].classList.remove("active");
      } else {
        registerForm.classList.add("active");
        loginForm.classList.remove("active");
        toggleBtns[1].classList.add("active");
        toggleBtns[0].classList.remove("active");
      }
    }

    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const icon = input.parentElement.querySelector(".password-toggle i");

      if (input.type === "password") {
        input.type = "text";
        icon.classList.remove("fa-eye");
        icon.classList.add("fa-eye-slash");
      } else {
        input.type = "password";
        icon.classList.remove("fa-eye-slash");
        icon.classList.add("fa-eye");
      }
    }

    function handleLogin(event) {
      event.preventDefault();

      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;

      // Aqu√≠ ir√° tu l√≥gica de login con Django
      console.log("Login:", { email, password });

      // Ejemplo de validaci√≥n
      if (email && password) {
        // Redirigir al dashboard o mostrar mensaje de √©xito
        alert("¬°Inicio de sesi√≥n exitoso! Redirigiendo al dashboard...");
        // window.location.href = '/dashboard';
      } else {
        showError("loginError");
      }
    }

    function handleRegister(event) {
      event.preventDefault();

      const name = document.getElementById("registerName").value;
      const email = document.getElementById("registerEmail").value;
      const password = document.getElementById("registerPassword").value;
      const confirmPassword = document.getElementById(
        "registerConfirmPassword"
      ).value;

      // Validar que las contrase√±as coincidan
      if (password !== confirmPassword) {
        showError("registerError");
        document.getElementById("registerError").innerHTML =
          '<i class="fas fa-exclamation-circle"></i> Las contrase√±as no coinciden';
        return;
      }

      // Aqu√≠ ir√° tu l√≥gica de registro con Django
      console.log("Register:", { name, email, password });

      // Ejemplo de validaci√≥n
      if (name && email && password) {
        alert("¬°Registro exitoso! Por favor inicia sesi√≥n.");
        showForm("login");
      } else {
        showError("registerError");
      }
    }

    function showError(errorId) {
      const errorElement = document.getElementById(errorId);
      errorElement.classList.add("show");

      setTimeout(() => {
        errorElement.classList.remove("show");
      }, 3000);
    }

    // Validaci√≥n en tiempo real de contrase√±as
    document
      .getElementById("registerConfirmPassword")
      ?.addEventListener("input", function () {
        const password = document.getElementById("registerPassword").value;
        const confirmPassword = this.value;

        if (confirmPassword && password !== confirmPassword) {
          this.style.borderColor = "var(--error)";
        } else {
          this.style.borderColor = "#e0e0e0";
        }
      });
  </script>
</div>
{% endblock %}
